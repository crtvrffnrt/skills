---
name: pentest-advanced-access-control-auditor
description: "Security assessment skill for identifying and exploiting authorization failures, including IDOR, BFLA, and vertical/horizontal privilege escalation. Use when prompts include access control, IDOR, BOLA, BFLA, or privilege escalation. Do not use for initial recon or pure input fuzzing."
---

## Skill: `advanced-access-control-auditor`

### 1. Scope & Objective
**Objective**: To systematically identify and exploit authorization failures, including Insecure Direct Object References (IDOR), Broken Function Level Authorization (BFLA), and vertical/horizontal privilege escalation.
**Scope**:
- REST APIs, RPC endpoints, GraphQL resolvers, and internal administrative interfaces.
- User role boundaries (Unauthenticated -> User -> Admin).
- Multi-tenant data isolation and cross-account resource access.

### 2. Inputs & Outputs
**Inputs**:
- `Target URL`: The base application URL.
- `Role Matrix`: A set of valid session tokens for different privilege levels (e.g., `UserA`, `UserB`, `Admin`).
- `Resource Map`: List of known object IDs (UUIDs, integers) and function names.

**Outputs**:
- `Vulnerability Report`: Confirmed instances of unauthorized access with reproduction steps.
- `Escalation Path`: A demonstrated chain from low-privilege access to high-privilege action.
- `Data Leakage Proof`: Samples of unauthorized data retrieved (e.g., PII, config).

### 3. Success Metrics
- **Confirmed Escalation**: Successfully performing an administrative action (create, delete, modify) from a non-admin context.
- **Data Exfiltration**: Retrieving sensitive records belonging to another user or tenant.
- **Bypass Verification**: Circumventing a specific access control check (e.g., bypassing a password requirement for profile updates).

### 4. Common Attack Vectors & Exploit Primitives
- **IDOR/BOLA**: Incrementing integer IDs or swapping UUIDs in API calls to access other users' objects.
- **BFLA**: Forcing execution of administrative functions (e.g., `admin_createUser`) by a standard user. (Do not delete any User)
- **Parameter Pollution (HPP)**: Supplying multiple values for the same parameter (e.g., `?id=admin&id=user`) to confuse backend logic.
- **Method Tampering**: Changing HTTP methods (e.g., `GET` to `POST`, `PUT` to `PATCH`) to bypass ACLs applied only to specific verbs.
- **Metadata Abuse**: Leveraging exposed internal API definitions (OData, Swagger, WSDL) to construct valid requests for hidden endpoints.

### 5. Security Controls to Test Against
- **Role-Based Access Control (RBAC)**: Verify that specific roles are strictly enforced at the function level.
- **Ownership Validation**: Ensure users can only access objects they explicitly own.
- **Session Integrity**: Check for session fixation and proper invalidation upon privilege change.

### 6. Concrete Examples
**Example 1: IDOR in User Profile**
*   **Context**: User A (ID: 101) wants to view User B (ID: 102).
*   **Attack**: `GET /api/v1/users/102` with User A's session token.
*   **Success**: Server returns User B's profile data (PII, settings).

**Example 2: BFLA in Administrative Function**
*   **Context**: Only admins should be able to delete users.
*   **Attack**: `POST /api/admin/deleteUser` with payload `{"user_id": 102}` using User A's session.
*   **Success**: Server processes the request and deletes User B.

**Example 3: Parameter Pollution for Logic Bypass**
*   **Context**: An endpoint accepts a `role` parameter during registration, defaulting to `user`.
*   **Attack**: `POST /register?role=admin&role=user`
*   **Success**: Application processes the first `role=admin` and creates an administrator account.
